# Plan for decoupling velut from Excel

For context, see [this project’s readme](https://github.com/DuncanRitchie/velut#readme). If none of this makes sense to you, I apologize.

I’ve already made several webpages made with vanilla HTML/CSS/JavaScript that I use to manage velut, in addition to the gigantic Excel file. I’ll probably be making more webpages and Node scripts to fulfil the steps below. The steps are in chronological order.

- [x] Port velut to Next.js. <ins>Completed 2022-07-23.</ins>
- [x] Decide whether to cancel my Render subscription for serving the MERN version. <ins>Subscription suspended 2022-09-10.</ins>
- [x] Make a webpage (or similar) that replaces the Excel sheet `wordsform`, which generates the phonetic data (etc) for each word. (Top-right in the [Excel screenshot](https://github.com/DuncanRitchie/velut#excel) in the readme.) It doesn’t need database access. <ins>[Word Data Generator](https://github.com/DuncanRitchie/velut-word-data-generator) completed 2022-09-29.</ins>
- [x] For each lemma in velut, generate the list of forms already in velut. This should be something that can be repeated easily whenever I add to the Excel file. A webpage that has `<textarea>`s for relevant data would suffice. Name it the Forms Collator (or something better). <ins>[Forms Collator](https://github.com/DuncanRitchie/velut-forms-collator) completed 2022-10-08.</ins>
- [x] Export the manually-entered data of `lemmata` into Json. (This is the Excel sheet bottom-left in the screenshot.) <ins>Done 2022-10-09.</ins>
- [x] Write something that generates an empty list for each lemma. Name it the Inflector. <ins>Done 2022-10-15</ins>
- [x] Write tests that compare the output of the Forms Collator (the lists of forms already in velut) to the output of the Inflector (a set of empty lists, at this point in time). The tests will fail for all lemmata. <ins>Done 2022-10-15</ins>
- [x] Make the Inflector return the lemma for conjunctions and prepositions, which will make some tests pass. <ins>Done 2022-10-15</ins>
- [x] Make the Inflector return the forms for each lemma as an object containing all parsing data. I don’t want an array of simple strings (`["amō","amās","amat",...]`) for each lemma, but something more like this (for a verb):<br>

<pre><code>
          {
            "unencliticized": {
              "indicative": {
                "active": {
                  "present": {
                    "singular": {
                      "1st": ["amō"],
                      "2nd": ["amās"],
                      "3rd": ["amat"]
                    }
                  }
                }
              }
            }
          }
</code></pre>
<ins>Done 2022-10-15</ins>

- [x] Make sure tests can handle what the Inflector generates. If the Forms Collator gives `["amō","amās","amat"]` and the Inflector gives the object above, the tests should pass because the forms are the same. Order does not matter. <ins>Done 2022-10-15</ins>
- [x] Handling for enclitics — make it so that all forms (where relevant) generated by the Inflector have encliticized forms as well as the unencliticized form. The enclitics in Latin are ‘[-que](https://www.velut.co.uk/-que)’, ‘[-ne](https://www.velut.co.uk/-ne)’, and ‘[-ve](https://www.velut.co.uk/-ve)’. (Exemptions include conjunctions and lemmata already ending in “-que” such as ‘[quisque](https://www.velut.co.uk/quisque)’. The word ‘ūsquene’ is attested, however.) <ins>Done 2022-10-15</ins>
- [x] Add whatever special cases need to be added to make all the tests pass for conjunctions and prepositions. (Because some conjunctions/prepositions have forms other than the lemma.) <ins>Done 2022-10-15</ins>
- [x] Make the Inflector generate the positive/comparative/superlative forms for adverbs. (Some adverbs will need to be marked as not having comparative/superlatives. There may be other special cases too.) <ins>Done 2022-10-30</ins>
- [x] Make the Inflector generate the forms for adjectives. (Some adjectives will need to be marked as not having comparative/superlatives/etc. There may be other special cases too.) <ins>Done 2022-11-13, though I’m temporarily excluding comparatives/superlatives that are not already in velut.</ins>
- [ ] Continue for pronouns, nouns (including proper nouns), and verbs. <ins>Pronouns finished 2022-11-18. Non-proper nouns finished 2022-12-10. Proper nouns finished 2022-12-30. ‘[sum](https://www.velut.co.uk/sum)’ and its componds finished 2023-01-15. Other verbs not started.</ins>
- [ ] Eventually the list of words in Excel will match that generated by the Inflector, or at least be a subset thereof. (Order does not matter.) Tests will pass.
- [ ] Confirm that, if unencliticized forms are generated that are not in Excel, they are _all_ worthy of being added to velut.
- [ ] Implement programmatic handling of ambiguously stressed forms.<br><br>
      What do I mean by this?<br><br>
      Some pairs of lemmata have particular forms that are identical except for the stress.
      For example, ‘[dominus](https://www.velut.co.uk/dominus)’ “lord” and ‘[dominium](https://www.velut.co.uk/dominium)’ “banquet” both have a genitive singular ‘[dominī](https://www.velut.co.uk/domini-)’, stressed on the first syllable for “of the lord” and on the second for “of the banquet”.
      In velut, I differentiate between the two by putting an acute accent on ‘[domínī](https://www.velut.co.uk/domi.ni-)’ “of the banquet”.<br><br>
      (I don’t put the acute on words that don’t need it due to not matching a word with a different stress.
      Eg, words like ‘[imperī](https://www.velut.co.uk/imperi-)’ — genitive singular of ‘[imperium](https://www.velut.co.uk/imperium)’ — have the stress on penultimate syllable just like ‘domínī’, but there’s no other way of stressing ‘imperī’, so I forgo the accent.)<br><br>
      Currently, I apply the acute accent manually… if I notice that forms can coincide like this. I’d like to have an automated solution.
- [ ] Check that the previous step hasn’t changed any of the data, beyond correcting any accenting mistakes that may exist.
- [ ] Refactor code for the Inflector.
- [ ] Check that the previous step hasn’t changed any of the data.
- [x] Stop adding words to the Excel file. <ins>I haven’t touched the Excel file since 2022-10-09.</ins>
- [ ] Make the parsing data generated by the Inflector get merged into the Json file for the `lemmata` MongoDB collection. Every lemma will have the `Lemma`, `PartOfSpeech`, `Meanings` (etc) fields that it currently has, but also a `Forms` field that is the object of parsing data.
- [ ] Replace the `lemmata` collection in MongoDB with the output of the previous step.
- [ ] Create a script that reads the parsing data that was generated by the Inflector, and condenses them into the simple “word and its lemmata” format that the Word Data Generator requires. (This is like the reverse of the Forms Collator: a Lemmata Collator.)
- [ ] Run the output of the Lemmata Collator through the Word Data Generator<br>
      (At this point I could also paste the output of the Lemmata Collator back into the `wordsform` sheet that the Word Data Generator replaces. Excel would probably crash though.)
- [ ] Replace the `words` collection in MongoDB with the output of the Word Data Generator in the previous step.
- [ ] Check that it is relatively easy to add vocabulary to velut. This means:

      1. adding a lemma (or several!) to my relevant Json file,
      2. getting the inflected forms with the Inflector,
      3. passing the forms into the Word Data Generator via the Lemmata Collator,
      4. manually checking that the data are correct,
      5. importing to MongoDB, and
      6. manually checking that the words look correct on the live website.

- [ ] Add inflection-tables on the front-end, using the output of the Inflector.<br>
      An example from Wiktionary:<br>
      ![Declension table for the noun ‘verbum’, with singular and plural forms for the six grammatical cases](https://github.com/DuncanRitchie/velut-screenshots/blob/main/compressed/wiktionary-declension-table.png)
- [ ] Decide whether inflection-tables should include encliticized forms.
- [ ] Ensure everything in the Excel file exists outside of it.
- [ ] Evaluate whether the Excel file can be deprecated.
- [ ] Continue adding words and going through issues. (I have several private Trello boards, including one for velut.)
